<<<<<<< HEAD
YUI.add("gallery-twitter-widget",function(E){var C=/@(\w+)/g,B=/((?:https?|s?ftp|ssh)\:\/\/[^"\s<>]*[^.,;'">\:\s<>\)\]\!])/g,D=/#(\w+)/g,A;A=E.Base.create("Twitter",E.Widget,[],{PHOTO_TEMPLATE:'<div class="twitter-photo"><a href="{url}"><img src="{profile_image_url}"></a></div>',ENTRY_TEMPLATE:'<div class="twitter-update">{img}'+'<div class="twitter-entry"><div class="writer">{userTplt}</div>{text} {time}</div>'+"</div>",TIME_TEMPLATE:'<span class="twitter-timestamp">{relativeTime}</span>',USER_TEMPLATE:'<a href="{url}" class="twitter-username">{username}</a>',TITLE_TEMPLATE:'<h3 class="twitter-title">{title} {user}</h3>',interval:null,initializer:function(F){this.publish({data:{defaultFn:this._defDataFn},error:{defaultFn:this._defErrorFn}});this._initJSONPRequest();this.after({usernameChange:this._refreshJSONPRequest,countChange:this._refreshJSONPRequest});},_initJSONPRequest:function(){var F=this.get("key"),H={count:this.get("count"),d:(new Date()).getTime(),key:this.get("isQuery")?F:"from:"+F},G=E.Lang.sub(A.SEARCH_API_URI,H).replace("#","%23");this._jsonpHandle=new E.JSONPRequest(G,{on:{success:this._handleJSONPResponse,failure:this._defErrorFn},context:this});},_refreshJSONPRequest:function(){this._initJSONPRequest();this.syncUI();},renderUI:function(){this.get("contentBox").append('<div class="yui3-twitter-hdr"></div><div class="yui3-twitter-bdy"><ul class="twitter-updates'+(this.get("showPhoto")?" photo":"")+'"></ul></div><div class="yui3-twitter-ftr"><div class="img">&nbsp;</div></div>');if(this.get("hideSkin")){this.get("boundingBox").addClass("noskin");}},bindUI:function(){this.after("usernameChange",this.syncUI);this.after("countChange",this.syncUI);this.after("stringsChange",this.syncUI);this.after("refreshSecondsChange",this._updateInterval);},syncUI:function(){this._uiUpdateTitle();this.update();this._updateInterval();},_uiUpdateTitle:function(){var F=this.get("contentBox").one(".yui3-twitter-hdr"),J=F.one(".twitter-status-title"),I,G,H;if(this.get("includeTitle")){G=this.get("key");H=this.get("isQuery");I=E.Lang.sub(this.TITLE_TEMPLATE,{title:this.get("strings.title"),user:E.Lang.sub(this.USER_TEMPLATE,{username:H?G:"@"+G,url:H?A.TREND_URL+G.replace("#","%23"):A.PROFILE_URL+G})});if(J){J.replace(I);}else{F.prepend(I);}}else{if(J){J.remove();}}},update:function(){this._jsonpHandle.send();},_handleJSONPResponse:function(F){if(E.Lang.isObject(F)){this.fire("data",{data:F});}else{this.fire("error");}},_defDataFn:function(F){this.get("contentBox").removeClass("twitter-error");this._printEntries(F.data);},_printEntries:function(H){var G=this.get("contentBox"),F=this._createEntries(H);G.one(".twitter-updates").setContent("<li>"+F.join("</li><li>")+"</li>");},_createEntries:function(J){var F=[],I=J.results||J,H;for(H=I.length-1;H>=0;--H){I[H].relativeTime=E.toRelativeTime(new Date(Date.parse(I[H].created_at.replace(/\+\d+/,""))));var G=J.results?I[H].from_user:I[H].user.screen_name;I[H].url=A.PROFILE_URL+G;I[H].username=G;F[H]=this._createEntry(I[H]);}return F;},_createEntry:function(J){var I=this.get("showTime");var H=E.Lang.sub(this.ENTRY_TEMPLATE,J).replace(B,'<a href="$1">$1</a>').replace(C,'<a class="twitter-acct" href="'+A.PROFILE_URL+'$1">@$1</a>').replace(D,'<a class="twitter-hash" href="'+A.TREND_URL+'%23$1"/>#$1</a>'),K=this.get("showTime")?E.Lang.sub(this.TIME_TEMPLATE,J):"",G=this.get("showHandle")?E.Lang.sub(this.USER_TEMPLATE,J):"",F=this.get("showPhoto")?E.Lang.sub(this.PHOTO_TEMPLATE,J):"";return E.Lang.sub(H,{img:F,userTplt:G,time:K});},_defErrorFn:function(){this.get("contentBox").one("ul.twitter-updates").addClass("twitter-error").setContent("<li><em>"+this.get("strings.error")+"</em></li>");},_updateInterval:function(){if(this.interval){this.interval.cancel();}this.interval=E.later(this.get("refreshSeconds")*1000,this,this.update,null,true);}},{PROFILE_URL:"https://twitter.com/#!/",TREND_URL:"https://twitter.com/#!/search/",SEARCH_API_URI:"http://search.twitter.com/search.json?q={key}&count={count}&d={d}&callback={callback}",ATTRS:{key:{},isQuery:{value:false,validator:E.Lang.isBoolean},count:{value:10,validator:E.Lang.isNumber},refreshSeconds:{value:300,validator:E.Lang.isNumber},strings:{value:{title:"Latest Updates",error:"Oops!  We had some trouble connecting to Twitter :("}},showPhoto:{value:true,validator:E.Lang.isBoolean},showHandle:{value:true,validator:E.Lang.isBoolean},includeTitle:{value:true,validator:E.Lang.isBoolean},hideSkin:{value:false,validator:E.Lang.isBoolean},showTime:{value:true,validator:E.Lang.isBoolean}}});E.namespace("Twitter").Status=A;},"@VERSION@",{skinnable:true,requires:["widget-base","substitute","gallery-torelativetime","jsonp","base-build"]});
=======
YUI.add("gallery-twitter-widget",function(e){var c=/@(\w+)/g,b=/((?:https?|s?ftp|ssh)\:\/\/[^"\s<>]*[^.,;'">\:\s<>\)\]\!])/g,d=/#(\w+)/g,a;a=e.Base.create("Twitter",e.Widget,[],{PHOTO_TEMPLATE:'<div class="twitter-photo"><a href="{url}"><img src="{profile_image_url}"></a></div>',ENTRY_TEMPLATE:'<div class="twitter-update">{img}'+'<div class="twitter-entry"><div class="writer">{userTplt}</div>{text} {time}</div>'+"</div>",TIME_TEMPLATE:'<span class="twitter-timestamp">{relativeTime}</span>',USER_TEMPLATE:'<a href="{url}" class="twitter-username">{username}</a>',TITLE_TEMPLATE:'<h3 class="twitter-title">{title} {user}</h3>',interval:null,initializer:function(f){this.publish({data:{defaultFn:this._defDataFn},error:{defaultFn:this._defErrorFn}});this._initJSONPRequest();this.after({usernameChange:this._refreshJSONPRequest,countChange:this._refreshJSONPRequest});},_initJSONPRequest:function(){var f=this.get("key"),h={count:this.get("count"),d:(new Date()).getTime(),key:this.get("isQuery")?f:"from:"+f},g=e.Lang.sub(a.SEARCH_API_URI,h).replace("#","%23");this._jsonpHandle=new e.JSONPRequest(g,{on:{success:this._handleJSONPResponse,failure:this._defErrorFn},context:this});},_refreshJSONPRequest:function(){this._initJSONPRequest();this.syncUI();},renderUI:function(){this.get("contentBox").append('<div class="yui3-twitter-hdr"></div><div class="yui3-twitter-bdy"><ul class="twitter-updates'+(this.get("showPhoto")?" photo":"")+'"></ul></div><div class="yui3-twitter-ftr"><div class="img">&nbsp;</div></div>');if(this.get("hideSkin")){this.get("boundingBox").addClass("noskin");}},bindUI:function(){this.after("usernameChange",this.syncUI);this.after("countChange",this.syncUI);this.after("stringsChange",this.syncUI);this.after("refreshSecondsChange",this._updateInterval);},syncUI:function(){this._uiUpdateTitle();this.update();this._updateInterval();},_uiUpdateTitle:function(){var f=this.get("contentBox").one(".yui3-twitter-hdr"),j=f.one(".twitter-status-title"),i,g,h;if(this.get("includeTitle")){g=this.get("key");h=this.get("isQuery");i=e.Lang.sub(this.TITLE_TEMPLATE,{title:this.get("strings.title"),user:e.Lang.sub(this.USER_TEMPLATE,{username:h?g:"@"+g,url:h?a.TREND_URL+g.replace("#","%23"):a.PROFILE_URL+g})});if(j){j.replace(i);}else{f.prepend(i);}}else{if(j){j.remove();}}},update:function(){this._jsonpHandle.send();},_handleJSONPResponse:function(f){if(e.Lang.isObject(f)){this.fire("data",{data:f});}else{this.fire("error");}},_defDataFn:function(f){this.get("contentBox").removeClass("twitter-error");this._printEntries(f.data);},_printEntries:function(h){var g=this.get("contentBox"),f=this._createEntries(h);g.one(".twitter-updates").setContent("<li>"+f.join("</li><li>")+"</li>");},_createEntries:function(k){var f=[],j=k.results||k,h;for(h=j.length-1;h>=0;--h){j[h].relativeTime=e.toRelativeTime(new Date(Date.parse(j[h].created_at.replace(/\+\d+/,""))));var g=k.results?j[h].from_user:j[h].user.screen_name;j[h].url=a.PROFILE_URL+g;j[h].username=g;f[h]=this._createEntry(j[h]);}return f;},_createEntry:function(j){var i=this.get("showTime");var h=e.Lang.sub(this.ENTRY_TEMPLATE,j).replace(b,'<a href="$1">$1</a>').replace(c,'<a class="twitter-acct" href="'+a.PROFILE_URL+'$1">@$1</a>').replace(d,'<a class="twitter-hash" href="'+a.TREND_URL+'%23$1"/>#$1</a>'),k=this.get("showTime")?e.Lang.sub(this.TIME_TEMPLATE,j):"",g=this.get("showHandle")?e.Lang.sub(this.USER_TEMPLATE,j):"",f=this.get("showPhoto")?e.Lang.sub(this.PHOTO_TEMPLATE,j):"";return e.Lang.sub(h,{img:f,userTplt:g,time:k});},_defErrorFn:function(){this.get("contentBox").one("ul.twitter-updates").addClass("twitter-error").setContent("<li><em>"+this.get("strings.error")+"</em></li>");},_updateInterval:function(){if(this.interval){this.interval.cancel();}this.interval=e.later(this.get("refreshSeconds")*1000,this,this.update,null,true);}},{PROFILE_URL:"https://twitter.com/#!/",TREND_URL:"https://twitter.com/#!/search/",SEARCH_API_URI:"http://search.twitter.com/search.json?q={key}&count={count}&d={d}&callback={callback}",ATTRS:{key:{},isQuery:{value:false,validator:e.Lang.isBoolean},count:{value:10,validator:e.Lang.isNumber},refreshSeconds:{value:300,validator:e.Lang.isNumber},strings:{value:{title:"Latest Updates",error:"Oops!  We had some trouble connecting to Twitter :("}},showPhoto:{value:true,validator:e.Lang.isBoolean},showHandle:{value:true,validator:e.Lang.isBoolean},includeTitle:{value:true,validator:e.Lang.isBoolean},hideSkin:{value:false,validator:e.Lang.isBoolean},showTime:{value:true,validator:e.Lang.isBoolean}}});e.namespace("Twitter").Status=a;},"gallery-2012.11.07-21-32",{requires:["widget-base","substitute","gallery-torelativetime","jsonp","base-build"],skinnable:true});
>>>>>>> upstream/master
