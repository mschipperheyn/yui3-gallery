YUI.add("gallery-more-loader",function(H){var C="MoreLoader",D="container",G="start",B="load",A="error",F="max";function E(I){E.superclass.constructor.apply(this,arguments);}E.NAME=C;H.extend(E,H.Base,{initializer:function(I){var K=this.get(D),J=this.get("moreBtn");this.publish(B,{defaultFn:this._defCompleteFn});this.publish(G,{});this.publish(A,{});this.publish(F,{});this.start=this.get("start");this.max=this.get("max");this.count=this.get("count");this.loading=false;if(J){J.on("click",function(L){this.loadContent(this._getUrl(I.url,this.start,this.max));},this);}if(this.get("autoRepeat")>0){this.startTimer();}},startTimer:function(){var J=this.get("autoRepeat")*1000,I=this;if(J>0&&!this.timer){this.timer=setInterval(function(){I.loadContent(I._getUrl(I.get("url"),I.start,I.max));},J);}},stopTimer:function(){if(this.timer){clearInterval(this.timer);}},loadContent:function(I){if(this.loading||(this.count>0&&this.start>=this.count)){return;}this.loading=true;this.fire(G,{url:I});H.io(I,{on:{success:this._processResult,failure:this._processResult},timeour:10000,context:this});},_processResult:function(O,K){var J=K.status,M=J<300?B:A,L=K.responseText,I=this.get("contentSelector"),N={start:this.start,content:L,responseText:K.responseText,status:J};if(M===B){if(I!==null&&L){N.content=H.Node.create(L).one(I).get("innerHTML");}}this.loading=false;this.fire(M,N);},_defCompleteFn:function(L){this.start=this.start+this.max;var I=this.get(D);if(I&&L.content){var K=this.get("anim"),J=H.Node.create(K?'<div style="opacity:0;">'+L.content+"</div>":L.content);if(this.get("append")){I.append(J);}else{I.prepend(J);}if(K){J.transition({opacity:{easing:"ease-in",duration:0.6,value:100}});}}if(this.count>0&&this.start>=this.count){this.fire(F);}},_getUrl:function(J,K,I){if(J.indexOf("{st}")>-1){return H.Lang.sub(this.get("url"),{start:K,max:I,dte:new Date().getMilliseconds()});}return J;},destructor:function(){this.stopTimer();this.get("moreBtn")&&this.get("moreBtn").destroy();}},{ATTRS:{url:null,start:{value:0},max:{value:0},count:{value:0},append:{value:true},anim:{value:true},autoRepeat:{value:0},container:{value:null,setter:H.one},moreBtn:{value:null,setter:H.one},contentSelector:{value:null}}});H[C]=E;},"@VERSION@",{requires:["node-base","io-base","transition"]});